<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>Ajax Test | Module | Sample | 디노웍스 관리시스템</title>
    <meta name="description" content="디노웍스 관리시스템 샘플 Edit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=1400" />
    <meta name="apple-mobile-web-app-title" content="디노웍스" />
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
    <link rel="stylesheet" href="../../lib/fa/css/all.min.css" />
    <link rel="stylesheet" href="../../lib/air-datepicker/datepicker.min.css" />
    <link rel="stylesheet" href="../../css/web-font.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <script src="../../lib/tinymce/tinymce.min.js"></script>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script src="../../lib/air-datepicker/datepicker.min.js"></script>
    <script src="../../lib/air-datepicker/datepicker.ko.js"></script>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script src="../../js/dino-common.js"></script>
  </head>
  <body class="sub sample design edit">
    <div id="wrapper">
      <a href="#main" id="skip-nav">본문 바로가기</a>
      <header id="header">
        <div class="logo">
          <h1>
            <a href="#" class="default"><img alt="DinoWorks" src="../../img/logo.png" /></a>
            <a href="#" class="circle">DinoWorks</a>
          </h1>
          <a href="#" class="toggle"><i class="fa-solid fa-angle-left"><span>네비게이션 열기/닫기</span></i></a>
        </div>
        <div class="user">
          <span class="photo" style="background-image: url(../../img/common/sample-face.jpg);">사용자 사진</span>
          <em class="name">김정민<span>(전체관리자)</span></em>
          <a href="#" class="toggle"><i class="fa-solid fa-angle-down"><span>사용자 상세정보 열기/닫기</span></i></a>
          <div class="layer-info">

          </div>
        </div>
        <ul id="header-link">
          <li><a href="#" title="로그아웃"><i class="fa-solid fa-arrow-right-from-bracket"><span>로그아웃</span></i></a></li>
          <li><a href="#" target="_black" title="홈페이지 열기"><i class="fa-solid fa-desktop"><span>홈페이지 열기</span></i></a></li>
          <li><a href="#" title="개인정보설정"><i class="fa-solid fa-user-gear"><span>개인정보설정</span></i></a></li>
          <li><a href="#" title="비밀번호변경"><i class="fa-solid fa-lock"><span>비밀번호변경</span></i></a></li>
          <li><a href="#" title="알람"><i class="fa-regular fa-bell"><span>알람</span></i></a></li>
        </ul>
      </header>

      <section id="gnb" class="custom-scroll">
        <h2 class="ir-hidden">네비게이션</h2>
        <nav>
          <h3>OVERIVEW</h3>
          <ul>
            <li><a href="../overview/dashboard.html" title="Dashboard Dashboard Dashboard"><i class="fa-solid fa-gauge"></i><em>Dashboard Dashboard Dashboard</em><i class="fa-solid fa-angle-right"><span>서브메뉴있음</span></i></a></li>
            <li>
              <a href="#"><i class="fa-solid fa-user-gear"></i><em>My Page</em></a>
              <ul>
                <li><a href="#">개인정보관리</a></li>
                <li><a href="#">비밀번호수정</a></li>
              </ul>
            </li>
          </ul>
          <h3>Sample</h3>
          <ul>
            <li>
              <a href="#"><i class="fa-solid fa-palette"></i><em>Design</em></a>
              <ul>
                <li><a href="../sample/design-layout.html">Layout</a></li>
                <li><a href="../sample/design-button.html">Button</a></li>
                <li><a href="../sample/design-form.html">Form</a></li>
                <li><a href="../sample/design-list.html">List Page</a></li>
                <li><a href="../sample/design-view.html">View Page</a></li>
                <li><a href="../sample/design-edit.html">Edit Page</a></li>
              </ul>
            </li>
            <li>
              <a href="#"><i class="fa-solid fa-cubes"></i><em>Module</em></a>
              <ul>
                <li><a href="../sample/module-list.html">DB List</a></li>
                <li><a href="../sample/module-view.html?seq=13">DB View</a></li>
                <li><a href="../sample/module-regist.html">DB Register</a></li>
                <li><a href="../sample/module-modify.html?seq=13">DB Modify</a></li>
                <li><a href="../sample/ajax-test.html">Ajax Test</a></li>
                <li><a href="../sample/ajax-list.html">Ajax List</a></li>
                <li><a href="../sample/ajax-view.html?seq=13">Ajax View</a></li>
                <li><a href="../sample/ajax-regist.html">Ajax Register</a></li>
                <li><a href="../sample/ajax-modify.html?seq=13">Ajax Modify</a></li>
              </ul>
            </li>
          </ul>
        </nav>
      </section>

      <main id="main">
        <h2>Ajax Test</h2>
        <p>폼페이지(edit) 샘플 : The most complete user interface framework that can be used to create stunning admin dashboards and presentation websites.</p>

        <section class="container type-1">
          <section>
            <h3>회원정보관리</h3>

            <h3>메뉴정보 (리스트)</h3>
              <table class="content">
                <caption>메뉴정보 리스트</caption>
                <colgroup>
                  <col style="width: 60px;" />
                  <col />
                </colgroup>
                <thead>
                  <th>No</th>
                  <th>기관명</th>
                  <th>기관구분</th>
                  <th>사업자번호</th>
                  <th>웹사이트 주소</th>
                </thead>
                <tbody>


                </tbody>
              </table>

          </section>
        </section>

        <div class="button-box right">
          <a href="#" id="ajax" class="btn large blue">Ajax 호출</a>
        </div>




      </main>

      <footer id="footer">
        <p>© Copyright 2022 DinoWorks Inc. All Rights Reserved.</p>
      </footer>
    </div> <!-- #wrapper -->

<script>
'use strict';


$('#ajax').on('click', function() {
  sendAjaxCall();
});


function sendAjaxCall() {
  // alert('test');
  let xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    // console.log('readyState : ' + this.readyState + ' / status : ' + this.status + ' / response : ' + this.responseText);

    // readyState	Holds the status of the XMLHttpRequest.
    // 0: request not initialized
    // 1: server connection established
    // 2: request received
    // 3: processing request
    // 4: request finished and response is ready
    // status	200: "OK"
    // 403: "Forbidden"
    // 404: "Page not found"
    if (this.readyState === 4 && this.status === 200) {
      // console.log('success');
      try {
        //배열을 json으로, 하지만 잘못된 값이 들어가면 this.responseText 자체에 오류 메세제가 들어감
        // var data = JSON.parse(this.responseText);
        var data = JSON.parse(this.responseText);
        console.log(data);
      } catch(e) {
        alert('Ajax call 에러가 발생했습니다.');
        console.warn('[Error Message] : ' + e);
        console.warn('[Server Message] : ' + this.responseText);
      }
    }
  }
  // true: 비동기 , false: 동기
  // 동기는 요청후 응답을 받아야함.
  // 비동기는 요청 후 응답과 상관없이 진행
  // xhr.open('get', 'model-ajax-test.php?test=1234', true);
  // xhr.send();

  // xhr.open('post', 'model-ajax-test.php', true);
  // //post는 header에 담아서 보내기 때문에 보낼값이 있다면 설정해줘야함
  // xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
  // xhr.send('test=1234');

  xhr.open('post', 'model-ajax-test.php', true);
  xhr.send();
}



// function sendAjaxCall() {
//   // console.log('call');

//   let xhr = new XMLHttpRequest();
//   xhr.onreadystatechange = function() {
//     console.log('readyState : ' + this.readyState + ' / status : ' + this.status);
//     if (this.readyState === 4 && this.status === 200) {
//       console.log('[success] : ' + this.responseText);

//       let data = JSON.parse(this.responseText);
//       console.log(data);

//     }
//   }

//   // post
//   xhr.open('post', 'model-ajax-test.php', true);
//   xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
//   xhr.send();

//   // get
//   /*
//   xhr.open('get', 'model-ajax-test.php?test=123', true);
//   xhr.send();
//   */

// }







/*
// ajax call
function AjaxCall(options) {
  let settings = {};
  let xhr = null;
  let sendDataQuery = '';
  let data = {};

  // 필수 옵션 점검
  if (options === undefined || options.url === undefined) {
    alert('정보를 가져올 대상 url을 지정해 주세요.');
    return false;
  }
  // 옵션값 정리
  settings.url = options.url;
  settings.showLog = (options === undefined || options.showLog === undefined) ? false : options.showLog;
  settings.method = (options === undefined || options.method === undefined) ? 'post' : options.method;
  settings.sendData = (options === undefined || options.sendData === undefined) ? {} : options.sendData;   // 객체 형식
  settings.success = (options === undefined || options.success === undefined) ? function() {} : options.success;
  for (let key in settings.sendData) {
    if (sendDataQuery !== '') sendDataQuery += '&';
    sendDataQuery += key + '=' + settings.sendData[key];
  }
  if (settings.showLog === true) console.log(sendDataQuery);

  function send() {
    xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
      if (settings.showLog === true) console.log('readyState : ' + this.readyState + ' / status : ' + this.status);
      if (this.readyState === 4 && this.status === 200) {
        try {
          var getData = JSON.parse(this.responseText);
          if (settings.showLog === true) console.log(getData);

          if (getData.status === undefined) {
            alert('처리할 상태정보(status)가 지정되지 않았습니다.');
          } else if (getData.status === 'invalid') {
            let index = parseInt(getData.index);
            let element = document.querySelectorAll('[name="' + getData.name + '"]')[index];
            if (element !== undefined) element.focus();  // 해당되는 요소가 있는 경우만 focus
            alert(getData.message);
          } else if (getData.status === 'valid') {
            if (getData.message !== undefined && getData.message !== '') alert(getData.message);
            if (getData.moveUrl !== undefined && getData.moveUrl !== '') location.href = getData.moveUrl;
            data = getData.frontData;
            settings.success(data);
          } else {
            alert('정의되지 않은 상태정보(status)가 전달되었습니다.');
          }
        } catch(e) {
          // console.log(e);
          alert('전송 내용이 정상적으로 처리되지 않았습니다.');
          console.warn('[Error Message]' + e);
          console.warn('[Response Message]' + this.responseText);
        }
      }
    }

    // ajax 실행
    if (settings.method === 'post') {
      xhr.open('post', settings.url, true);
      xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
      xhr.send(sendDataQuery);
    } else if (settings.method === 'get') {
      xhr.open("get", settings.url + ((sendDataQuery === '') ? '' : '?') + sendDataQuery, true);
      xhr.send();
    } else {
      alert('전송방식시 정상적(get 혹은 method)으로 선택되지 않았습니다.');
      return false;
    }
  }

  this.send = function() {send();}
}
*/











</script>
  </body>
</html>